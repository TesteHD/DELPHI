DROP VIEW VW_PRODUTO;
CREATE VIEW VW_PRODUTO(
    COD_PRODUTO,
    NOM_PRODUTO,
    COD_APRESENTACAO,
    NOM_APRESENTACAO,
    COD_P_ATIVO,
    NOM_P_ATIVO,
    COD_FORNECEDOR,
    NOM_FORNECEDOR,
    QTD_MAXIMO,
    QTD_MINIMO,
    FLG_ATIVO,
    DAT_IMPLANTACAO,
    QTD_FISICO_ANT,
    VAL_FISICO_ANT,
    QTD_FISICO,
    VAL_FINAN)
AS
Select 
A.COD_PRODUTO,
Case A.COD_P_ATIVO
  when 0 then
    Case when D.NOM_FORN_RESUMIDO is not null then
      A.NOM_PRODUTO||' '||B.NOM_APRESENTACAO||' - '||D.NOM_FORN_RESUMIDO
    Else
      A.NOM_PRODUTO||' '||B.NOM_APRESENTACAO
    End
  else
    Case when D.NOM_FORN_RESUMIDO is not null then
      A.NOM_PRODUTO||' '||B.NOM_APRESENTACAO||' ('||C.NOM_P_ATIVO||') - '||D.NOM_FORN_RESUMIDO
    Else
      A.NOM_PRODUTO||' '||B.NOM_APRESENTACAO||' ('||C.NOM_P_ATIVO||') '
    End
End As NOM_PRODUTO,
A.COD_APRESENTACAO,
B.NOM_APRESENTACAO,
A.COD_P_ATIVO,
C.NOM_P_ATIVO,
A.COD_FORNECEDOR,
D.NOM_FORNECEDOR,
A.QTD_MAXIMO,
A.QTD_MINIMO,
A.FLG_ATIVO,
A.DAT_IMPLANTACAO,
A.QTD_FISICO_ANT,
A.VAL_FISICO_ANT,
A.QTD_FISICO,
A.VAL_FINAN
From 
CAD_PRODUTO A,
CAD_APRESENTACAO B,
CAD_P_ATIVO C,
CAD_FORNECEDOR D
Where
A.COD_APRESENTACAO = B.COD_APRESENTACAO And
A.COD_P_ATIVO = C.COD_P_ATIVO And
A.COD_FORNECEDOR = D.COD_FORNECEDOR;
