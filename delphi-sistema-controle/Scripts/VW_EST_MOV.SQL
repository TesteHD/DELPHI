CREATE VIEW VW_EST_MOV(
    FLG_ES,
    COD_EMPRESA,
    COD_FILIAL,
    COD_FORNECEDOR,
    NUM_DOCUMENTO,
    NOM_SERIE,
    COD_PRODUTO,
    DAT_MOV,
    QTD_MOV,
    VAL_MOV,
    VAL_CUSTO,
    VAL_PRODUTO,
    QTD_FISICO,
    VAL_FINAN,
    FLG_TIPO)
AS
Select 
'E' FLG_ES,
COD_EMPRESA,
COD_FILIAL,
COD_FORNECEDOR,
NUM_DOCUMENTO,
NOM_SERIE,
COD_PRODUTO,
DAT_MOV,
QTD_MOV,
VAL_MOV,
VAL_CUSTO,
VAL_PRODUTO,
QTD_FISICO,
VAL_FINAN,
FLG_TIPO
From EST_ENTRADA
Union All
Select 
'S' FLG_ES,
COD_EMPRESA,
COD_FILIAL,
Cast(Null As Integer) COD_FORNECEDOR,
NUM_DOCUMENTO,
NOM_SERIE,
COD_PRODUTO,
DAT_MOV,
QTD_MOV,
VAL_MOV,
VAL_CUSTO,
VAL_PRODUTO,
QTD_FISICO,
VAL_FINAN,
FLG_TIPO
From EST_SAIDA